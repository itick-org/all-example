# 黄金价格订阅器 (Gold Price Subscriber)

这是一个基于 Node.js 的 WebSocket 客户端程序，用于实时订阅和记录黄金（XAUUSD）的价格数据。程序具有自动重连和日志记录功能。

## 功能特点

- 实时订阅 XAUUSD（黄金/美元）价格数据
- 自动断线重连（最多尝试100次）
- 详细的日志记录（控制台输出和文件记录）
- 使用上海时区显示时间戳

## 系统要求

- Node.js 版本 >= 22.0.0
- npm（Node.js 包管理器）

## 安装步骤

1. **安装 Node.js**
   - 访问 [Node.js 官网](https://nodejs.org/)
   - 下载并安装 Node.js 22.0.0 或更高版本
   - 安装完成后，打开终端（命令行），输入以下命令验证安装：
     ```bash
     node --version
     npm --version
     ```
   - 确保 node 版本号大于等于 22.0.0

2. **下载项目文件**
   - 确保你有以下文件：
     - `package.json`
     - `goldSubscriber.js`

3. **安装项目依赖**
   - 打开终端（命令行）
   - 进入项目所在目录：
     ```bash
     cd 项目目录路径
     ```
   - 安装依赖：
     ```bash
     npm install
     ```
   - 等待安装完成，这将安装 ws 和 winston 两个必需的包

## 运行程序

1. **启动程序**
   - 在项目目录下，运行以下命令：
     ```bash
     node goldSubscriber.js
     ```

2. **查看输出**
   - 程序启动后，你会在终端看到实时的日志输出
   - 同时，所有日志也会被记录到 `gold-price.log` 文件中

## 日志说明

- 程序运行时会产生两种形式的日志：
  1. 控制台输出：实时显示在终端中
  2. 文件日志：保存在 `gold-price.log` 文件中

- 日志内容包括：
  - 连接状态
  - 认证信息
  - 订阅状态
  - 接收到的价格数据
  - 错误信息（如果有）
  - 重连信息（如果发生断线）

## 常见问题解决

1. **如果看到 "无法连接到服务器" 错误**
   - 检查网络连接是否正常
   - 确认服务器地址 `wss://api.itick.org/fws` 是否可访问

2. **如果程序无法启动**
   - 确认 Node.js 版本是否符合要求（>=22.0.0）
   - 检查是否已经运行 `npm install` 安装了所有依赖

3. **如果看到依赖相关错误**
   - 删除 `node_modules` 文件夹
   - 重新运行 `npm install`

## 停止程序

- 在终端中按 `Ctrl + C`（Windows/Linux）或 `Command + C`（Mac）即可停止程序

## 注意事项

- 程序会自动处理断线重连，无需手动干预
- 所有价格数据都会使用上海时区时间戳记录
- 日志文件 `gold-price.log` 会持续增长，建议定期备份和清理

如需任何帮助，请参考代码中的详细注释或提出问题。
